/*! )°(, equolo - https://github.com/equolo/equolo.org */
/*@cc_on
(function(f){
window.setTimeout=f(window.setTimeout);
window.setInterval=f(window.setInterval);
})(function(f){return function(c,t,a){a=[].slice.call(arguments,2);return f(function(){c.apply(this,a)},t)}});
@*/
var
IEMobile=/*@cc_on/\bIEMobile\b/.test(navigator.userAgent)||@*/false,
IE9Mobile=/*@cc_on(IEMobile&&@_jscript_version<10)||@*/false,
IE10Mobile=/*@cc_on(IEMobile&&@_jscript_version/10>=1)||@*/false
;
IE9Mobile&&document.write('<link rel="stylesheet" href="css/IE9Mobile.css"/><script src="js/IE9Mobile.js"></script>');(function(b){(function(e,c,d){"indexOf" in e||(e.indexOf=function(f){for(var g=this.length;g--&&this[g]!==f;){}return g});"bind" in c||(c.bind=function(j){var i=this,h=e.slice,g=h.call(arguments,1);return function(){return i.apply(j,g.concat(h.call(arguments)))}});"trim" in d||(d.trim=function(){return this.replace(/^[^\S]+|[^\S]+$/g,"")})}(Array.prototype,Function.prototype,String.prototype));
/*! (C) WebReflection Mit Style License */
(function(z){function F(c){return typeof c=="string"?z.document.createTextNode(c):c}function m(f){if(f.length===1){return F(f[0])}for(var e=z.document.createDocumentFragment(),c=x.call(f),d=0;d<f.length;d++){e.appendChild(F(c[d]))}return e}for(var g,w,G,k=/^\s+|\s+$/g,E=/\s+/,C=" ",y=function(c,d){return this.contains(c)?d||this.remove(c):d&&this.add(c),!!d},q=(z.Element||z.Node||z.HTMLElement).prototype,B=["prepend",function(){var c=this.firstChild,d=m(arguments);c?this.insertBefore(d,c):this.appendChild(d)},"append",function(){this.appendChild(m(arguments))},"before",function(){var c=this.parentNode;c&&c.insertBefore(m(arguments),this)},"after",function(){var d=this.parentNode,e=this.nextSibling,c=m(arguments);d&&(e?d.insertBefore(c,e):d.appendChild(c))},"replace",function(){var c=this.parentNode;c&&c.replaceChild(m(arguments),this)},"remove",function(){var c=this.parentNode;c&&c.removeChild(this)}],x=B.slice,j=B.length;j;j-=2){g=B[j-2],g in q||(q[g]=B[j-1])}"classList" in document.documentElement?(G=document.createElement("div").classList,G.add("a","b"),"a b"!=G&&(q=G.constructor.prototype,"add" in q||(q=z.DOMTokenList.prototype),w=function(c){return function(){var d=0;while(d<arguments.length){c.call(this,arguments[d++])}}},q.add=w(q.add),q.remove=w(q.remove),q.toggle=y)):(w=function(c){if(!c){throw"SyntaxError"}if(E.test(c)){throw"InvalidCharacterError"}return c},G=function(d){var c=d.className.replace(k,"");c.length&&B.push.apply(this,c.split(E)),this._=d},G.prototype={length:0,add:function(){for(var c=0,d;c<arguments.length;c++){d=arguments[c],this.contains(d)||B.push.call(this,g)}this._.className=""+this},contains:function(c){return function(d){return j=c.call(this,g=w(d)),-1<j}}([].indexOf||function(c){j=this.length;while(j--&&this[j]!==c){}return j}),item:function(c){return this[c]||null},remove:function(){for(var c=0,d;c<arguments.length;c++){d=arguments[c],this.contains(d)&&B.splice.call(this,j,1)}this._.className=""+this},toggle:y,toString:function D(){return B.join.call(this,C)}},(Object.defineProperty||function(d,c,f){d.__defineGetter__(c,f.get)})(q,"classList",{get:function(){return new G(this)},set:function(){}}));try{new z.CustomEvent("?")}catch(A){z.CustomEvent=function(f,c){function h(o,e){var l=document.createEvent(f);if(typeof o!="string"){throw new Error("An event name must be provided")}return f=="Event"&&(l.initCustomEvent=d),e==null&&(e=c),l.initCustomEvent(o,e.bubbles,e.cancelable,e.detail),l}function d(o,i,p,l){this.initEvent(o,i,p),this.detail=l}return h}(z.CustomEvent?"CustomEvent":"Event",{bubbles:!1,cancelable:!1,detail:null})}})(b);
/*! (C) Andrea Giammarchi Mit Style License */
(function(aa){function H(){return{l:{},m:[],b:[]}}function q(d){var c=H();return ac.value=c,O(d,Z,ac),ac.value=null,c}function B(d,c,f){typeof c=="function"?c.apply(d,f):c.handleEvent.apply(c,f)}function j(d,c,f){f&&A(this,"detail",f),A(this,"type",c),A(this,"target",d),A(this,"timeStamp",R())}if(aa.eddy){return}aa.eddy=!0;var I=Array.prototype,Q=aa.prototype,M=j.prototype,W=Q.hasOwnProperty,J=I.push,P=I.slice,G=I.unshift,ae="toLocaleString",Z={toLocaleString:1}.propertyIsEnumerable(ae)?"_@eddy"+Math.random():ae,U=Z===ae,ac=(aa.create||aa)(null),X=[],O=U?function(d,c,f){d[c]=f.value}:aa.defineProperty,ab=function(d){var c=this;return function(){return c.apply(d,arguments)}},F=I.indexOf||function(d){var c=this.length;while(c--&&this[c]!==d){}return c},R=Date.now||function(){return(new Date).getTime()},Y={boundTo:function(e){var h=W.call(this,Z)?this[Z]:q(this),f=h.m,g=h.b,d=typeof e=="string"?this[e]:e,c=F.call(f,d);return c<0?g[J.call(f,d)-1]=ab.call(d,this):g[c]},emit:function(g){var m=W.call(this,Z),i=m&&this[Z].l,h=m&&W.call(i,g),f=h&&i[g],e=h&&P.call(arguments,1),d=0,k=h?f.length:d;while(d<k){B(this,f[d++],e)}return h},listeners:function(c){return W.call(this,Z)&&W.call(this[Z].l,c)&&this[Z].l[c].slice()||[]},off:function(d,h){var f=W.call(this,Z),e=f&&this[Z].l,g=f&&W.call(e,d)&&e[d],c;return g&&(c=F.call(g,h),-1<c&&(g.splice(c,1),g.length||delete e[d])),this},on:function(e,h,f){var g=W.call(this,Z),d=(g?this[Z]:q(this)).l,c=g&&W.call(d,e)?d[e]:d[e]=[];return F.call(c,h)<0&&(f?G:J).call(c,h),this},once:function(d,g,f){var c=function(h){e.off(d,c,f),B(e,g,arguments)},e=this;return e.on(d,c,f)},trigger:function(C,g){var E=W.call(this,Z),f=E&&this[Z].l,y=typeof C=="string",w=y?C:C.type,i=E&&W.call(f,w),r=i&&f[w].slice(0),e=y?new j(this,w,g):C,k=0,x=i?r.length:k,h=!(e instanceof j);h&&(e._active=!0,e.stopImmediatePropagation=M.stopImmediatePropagation),e.currentTarget=this,X[0]=e;while(e._active&&k<x){B(this,r[k++],X)}return h&&(delete e._active,delete e.stopImmediatePropagation),!e.defaultPrevented}},A=function(d,c,f){W.call(d,c)||(d[c]=f)},ad=!1,D;M.defaultPrevented=!1,M._active=M.cancelable=!0,M.preventDefault=function(){this.defaultPrevented=!0},M.stopImmediatePropagation=function(){this._active=!1};for(D in Y){W.call(Y,D)&&O(Q,D,{enumerable:!1,configurable:!0,writable:!0,value:Y[D]})}(function(d){function f(e){function g(h){h[e].apply(h,this)}return function(){return d.call(this,g,arguments),this}}for(var c in Y){Y.hasOwnProperty(c)&&!/^listeners|boundTo$/.test(c)&&O(I,c,{enumerable:!1,configurable:!0,writable:!0,value:f(c)})}})(I.forEach);var z={boundTo:Y.boundTo,data:function V(d,c){var f="dataset" in this;return arguments.length<2?f?this.dataset[d]:(c=this.getAttribute("data-"+d.replace(V.gre||(V.gre=/-[a-z]/g),V.gplace||(V.gplace=function(h,g){return g.toUpperCase()}))))==null?void 0:c:f?c==null?delete this.dataset[d]:(this.dataset[d]=c,c):(V.sre||(V.sre=/([a-z])([A-Z])/g,V.splace=function(h,g,i){return g+"-"+i.toLowerCase()}),d="data-"+d.replace(V.sre,V.splace),c==null?!this.removeAttribute(d):(this.setAttribute(d,c),c))},emit:function(d){var c=new CustomEvent(d);return c.arguments=I.slice.call(arguments,1),this.dispatchEvent(c)},listeners:function(c){return[]},off:function(d,c,f){return this.removeEventListener(d,c,f),this},on:function(d,c,f){return this.addEventListener(d,c,f),this},once:Y.once,trigger:function(d,g){var f=typeof d=="string",c=f?d:d.type,e=f?new CustomEvent(c,(ac.detail=g,ac)):d;return ac.detail=null,j.call(e,this,c),this.dispatchEvent(e)}};ac.cancelable=!0,ac.bubbles=!0;try{document.createEvent("Event").target=document}catch(K){ad=!0,A=function(f,c,g){if(!W.call(f,c)){try{f[c]=g}catch(d){}}}}(function(i){var f=i.Window,l=f?f.prototype:i,h=(i.Node||i.Element||i.HTMLElement).prototype,g=(i.Document||i.HTMLDocument).prototype,k=(i.XMLHttpRequest||function(){}).prototype,d,c;for(d in z){W.call(z,d)&&(c={enumerable:!1,configurable:!0,writable:!0,value:z[d]},O(l,d,c),O(h,d,c),O(g,d,c),d!=="data"&&O(k,d,c))}})(b)})(Object);b.$=function(c){return function(e,d){return c.slice.call(c.concat(d||document)[0].querySelectorAll(e))}}([]);
/*! SimpleKinetic v0.1.1 - MIT license */
;var a=function(d){var l=d.isNaN,e=d.Math,s=e.abs,r=e.round,o=e.sqrt,k=d.setInterval,p=d.clearInterval,g=0.2,q=9,m=1000/60,j=f.prototype;function f(t){for(var u in t){if(/^on|context|interval/.test(u)){this[u]=t[u]}}}j.init=function(J,I,A,w,D,B){var K=i(this),z=(s(A)<1?0:A)*(D?1:q),F=(s(w)<1?0:w)*(B?1:q),v=z*z,E=F*F,u=o(v+E),t=z/u,C=F/u,H,G;K.cancel(K._cx,K._cy);if(!(l(t)||l(C))){K._a=k(h,K.interval||m,K);K._t=0;K._d=u;K._sx=K._cx=J;K._sy=K._cy=I;K._xa=t;K._ya=C;H=r(J+u*t);G=r(I+u*C);K._ex=H;K._ey=G;if((J!==H||I!==G)&&K.start(J,I,0,0,H,G)!==false){return true}i(K._a)}return false};j.start=n("start");j.move=n("move");j.end=n("end");j.cancel=function(v,t,w,u,y,x){if(this._a){i(this).oncancel.call(this.context||this,v,t,w,u,y,x)}};j.onstart=j.onmove=j.onend=j.oncancel=function(v,t,w,u,y,x){};function i(t){p(t._a);t._a=0;return t}function n(t){t="on"+t;return function(w,u,x,v,z,y){return this[t].call(this.context||this,w,u,x,v,z,y)}}function h(v){var C=(v._t+=(v._d-v._t)*g),u=r(v._sx+C*v._xa),D=r(v._sy+C*v._ya),B=v._ex,z=v._ey,A=u-v._cx,w=D-v._cy;if(u===B&&D===z){i(v).end(B,z,A,w,B,z)}else{v.move(u,D,A,w,B,z);v._cx=u;v._cy=D}}var c=k(function(t){p(c);if(!t){k=function(w,v,u){return d.setInterval(function(){w(u)},v)}}},0,1);return f}(this);document.once("DOMContentLoaded",function(){var q=/^[^@]+?@[^\1@]+\.([a-z]{2,})$/,h=0,v={},k={handleEvent:function(y){var x=y.type,w;if("_type" in this){w=this._type+"-terminate";if(w in this){this[w](y)}}this._type=x;w=x+"-init";if(w in this){this[w](y)}u.enable($("fieldset#"+x)[0]);this[x](y)},"step-1":function(y){var x=$("fieldset#"+y.type)[0],w=$("select",x);w.once("change",function(){location.href=location.href.split(/[\?#]/)[0]+"?lang="+this.value});this.trigger("step-2")},"step-2":function(y){var x=$("fieldset#"+y.type)[0],w=$("input",x)[0];this.on("email:verified",j);w.on("keyup",this.boundTo(s));w.emit("keyup")},"step-3":function(H){var N=H.detail,K=$("fieldset"),I=$("fieldset#"+H.type)[0],x=$("select[name=activity]",I)[0],E=$("button[name=add]",I)[0],M=$("button[name=remove]",I)[0],F=$("button.next",I)[0],P=$("input[name=name]",I)[0],G=$("textarea[name=description]",I)[0],O=$("select[name=lang]",I)[0],A=$("div.lang > p > span",I)[0],B=$("ul",I)[0],D=$("div.criteria input",I),y=D.shift(),z=D.shift(),w=function(R){var Q=B.appendChild(document.createElement("li")),S=Q.appendChild(document.createElement("strong"));S.append("√");Q.append(S);Q.append(" "+o(O,R))},C=function(){M.disabled=!x.options.length;F.disabled=E.disabled=!(G.value&&P.value&&(g(y)||3<D.filter(g).length));if(F.disabled){if(this.hasOwnProperty("map")){K.slice(K.indexOf(I)+1).forEach(u.disable)}}else{F.emit("click")}}.bind(this),J;A.innerHTML=140;P.value=G.value=x.innerHTML=B.innerHTML="";x.on("change",this.onActivityChange||(this.onActivityChange=function(){N.currentActivity=this.value;H.currentTarget.trigger(H)}));P.on("keyup",this.onNameChange||(this.onNameChange=function(R){var S=P.value.trim(),Q=x.options[x.selectedIndex];r(N).name=S;if(S){Q.value=N.currentActivity;Q.innerHTML="";Q.append(S)}C()}));G.on("keyup",this.onDescriptionChange||(this.onDescriptionChange=function(U){var S=G.value.trim(),R=parseInt(G.getAttribute("maxlength"),10),T=(R-S.length),Q;if(T<0){T=0;G.value=S.slice(0,R)}A.innerHTML=T;Q=r(N).description;if(!(O.value in Q)){w(O.value)}Q[O.value]=S;if(!S.length){delete Q[O.value];B.innerHTML="";Object.keys(Q).forEach(w)}C()}));O.on("change",this.onLanguageDescriptionChange||(this.onLanguageDescriptionChange=function(R){var Q=r(N).description;G.value=Q[O.value]||"";G.emit("keyup")}));N.activities.forEach(function(T,R){if(/^remove:/.test(T.id)){return}var S=x.appendChild(document.createElement("option")),Q;S.value=T.id;S.append(T.name);if(!N.hasOwnProperty("currentActivity")||T.id==N.currentActivity){N.currentActivity=T.id;S.selected="selected";P.value=T.name;Q=Object.keys(T.description);Q.forEach.call(O.options,n,Q[0]);Q.forEach(w);G.value=T.description[O.value]||"";G.emit("keyup")}},this);E.on("click",this.onAnotherActivity||(this.onAnotherActivity=function(S){var Q=x.options,T;N.currentActivity=null;x.appendChild(document.createElement("option")).append(T=P.placeholder||P.getAttribute("placeholder"));P.value=G.value="";G.emit("keyup");try{P.focus()}catch(R){}D.concat(z,y).forEach(function(U){U.checked=false});x.selectedIndex=Q.length-1}));M.on("click",this.onRemoveActivity||(this.onRemoveActivity=function(S){var R=r(N),T=R.id,Q;if(/^new:/.test(T)){for(Q=0;Q<N.activities.length;Q++){if(N.activities[Q].id==T){N.activities.splice(Q,1);break}}}else{if(!/^remove:/.test(T)){R.id="remove:"+T}}N.currentActivity=null;x.selectedIndex--;x.emit("change")}));D.on("change",this.onCriteriaChange||(this.onCriteriaChange=function(){D.forEach(f,r(N).criteria=[]);C()}));J=N.currentActivity?r(N):{criteria:[],certification:[]};D.forEach(function(Q){Q.checked=-1<this.criteria.indexOf(Q.value);Q.parentNode.on("click",c)},J);z.checked=0<J.criteria.length;y.checked=0<J.certification.length;z.on("change",this.enableAddRemoveButtons||(this.enableAddRemoveButtons=C));y.on("change",this.onCertifiedEnabled||(this.onCertifiedEnabled=function(){r(N).certification=[true];C()}));F.on("click",this.onNextActivity||(this.onNextActivity=function(Q){r(N).currentPlace=null;this.trigger("step-4",N)}.bind(this)));C();if(E.disabled&&M.disabled){E.emit("click")}},"step-4":function(E){var B=E.detail,z=r(B),A=z.currentPlace||!z.place.length?l(z):z.place[0],H=$("fieldset#"+E.type)[0],F=$("i",H)[0],y=$("select[name=category]",H)[0],x=$("select[name=place]",H)[0],G=$("button[name=add]",H)[0],C=$("button[name=remove]",H)[0],y=$("select[name=category]",H)[0],w=$("div.map > button",H)[0],D=$("div.fields > input",H);z.currentPlace=A.id;$("fieldset",H).forEach(u.enable);if(!this.hasOwnProperty("map")){this.map=L.map("map");L.tileLayer("http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpg",{attribution:"Map Tiles &copy; Open MapQuest",maxZoom:18}).addTo(this.map);this.map.setView([navigator.country.geo.latitude,navigator.country.geo.longitude],5);x.on("change",function(){r(B).currentPlace=this.value;E.currentTarget.trigger(E)});G.on("click",function(){var M=r(B),J=x.options,I=(M.currentPlace=null)||l(M),K=x.appendChild(document.createElement("option"));K.append(" - ");K.value=I.id;x.selectedIndex=J.length-1;x.emit("change")});C.on("click",function(){var I=r(B);I.place.splice(I.place.indexOf(l(I)),1);x.options[x.selectedIndex--].remove();x.emit("change")});w.on("click",function(){w.disabled=true;try{navigator.geolocation.getCurrentPosition(function K(M){this.setView([M.coords.latitude,M.coords.longitude],Math.max(14,this.getZoom()));w.disabled=false}.bind(this),function I(){w.disabled=false},{maximumAge:600000})}catch(J){}}.bind(this.map));y.on("change",this.onCategoryChange||(this.onCategoryChange=function(I){F.className="icon-"+y.value}))}while(x.options.length){x.options[0].remove()}z.place.forEach(function(I,J){var K=x.appendChild(document.createElement("option"));K.value=I.id;K.append(I.road+" - "+I.postcode);if(I.id==z.currentPlace){K.selected="selected";x.selectedIndex=J}});D.forEach(function(I){I.value=A&&A[I.name]||""});D.on("keyup",p);p.target=A;if(A.latitude!=null){this.map.setView([A.latitude,A.longitude],Math.max(14,this.map.getZoom()))}}},e=["mousedown","mousemove","mouseup","click"],u={disable:function(w){w.classList.add("disabled");e.forEach(u._addStopEvent,w)},enable:function(w){w.classList.remove("disabled");e.forEach(u._removeStopEvent,w)},_addStopEvent:function(w){this.on(w,m,true)},_removeStopEvent:function(w){this.off(w,m,true)}};function m(w){w.preventDefault();(w.stopImmediatePropagation||w.stopPropagation).call(w)}function t(w,x){var z=x.value.trim(),y=x.data("email"),A;if(q.test(z)&&z!==y){x.data("email",z);w.xhr=A=new XMLHttpRequest;A.target=w;A.open("get","cgi/verify.php?email="+encodeURIComponent(z),true);A.on("readystatechange",i).send(null);v.email=z}}function j(x){var w=x.detail;switch(typeof w){case"object":v.activities=w;break;case"boolean":if(confirm(jslang.seeYouLater)){}location.href="http://equolo.org/";break;default:v.activities=[]}if(v.hasOwnProperty("activities")){this.trigger("step-3",v)}}function s(y){var w=y.currentTarget;v.email=null;try{this.xhr.abort()}catch(x){}clearTimeout(parseInt(w.data("timer")||0,10));if(q.test(w.value.trim())){w.data("timer",setTimeout(t,1000,this,w))}else{while(w=w.parentNode){if(w.nodeName==="FIELDSET"){$("fieldset").slice($("fieldset").indexOf(w)+1).forEach(u.disable);break}}}}function i(){if(this.readyState===4){this.target.trigger("email:verified",JSON.parse(this.responseText))}}function d(z,A){for(var x=0,y=z.length,w;x<y;x++){w=z[x];if(w.id==A){return w}}}function o(z,y){for(var w=z.options,x=0;x<w.length;x++){if(w[x].value==y){return w[x].innerHTML}}}function r(w){if(!w.currentActivity){w.activities.push({id:(w.currentActivity="new:".concat(++h)),name:"",description:{},criteria:[],certification:[],place:[]})}return d(w.activities,w.currentActivity)}function g(w){return w.checked}function c(w){if(w.target==this){this.firstChild.checked=!this.firstChild.checked;this.firstChild.emit("change")}}function n(w){w.selected=w.value==this?"selected":""}function f(w){if(w.checked){this.push(w.value)}}function l(w){if(!w.currentPlace){w.place.push({id:(w.currentPlace="new:".concat(++h)),icon:"",latitude:null,longitude:null,road:"",extra:"",postcode:"",city:"",county:"",state:"",country:"",email:"",phone:"",website:"",twitter:"",facebook:""})}return d(w.place,w.currentPlace)}function p(x){var w=x.currentTarget;p.target[w.name]=w.value}Object.keys(k).forEach(function(w){if(w!=="handleEvent"){this.on(w,this)}},k);$("fieldset").forEach(u.disable);k.trigger("step-1")})}(this));