/*! )°(, equolo - https://github.com/equolo/equolo.org */
/*@cc_on
(function(f){
window.setTimeout=f(window.setTimeout);
window.setInterval=f(window.setInterval);
})(function(f){return function(c,t,a){a=[].slice.call(arguments,2);return f(function(){c.apply(this,a)},t)}});
@*/
var
IEMobile=/*@cc_on/\bIEMobile\b/.test(navigator.userAgent)||@*/false,
IE9Mobile=/*@cc_on(IEMobile&&@_jscript_version<10)||@*/false,
IE10Mobile=/*@cc_on(IEMobile&&@_jscript_version/10>=1)||@*/false
;
IE9Mobile&&document.write('<link rel="stylesheet" href="css/IE9Mobile.css"/><script src="js/IE9Mobile.js"></script>');(function(b){(function(e,c,d){"indexOf" in e||(e.indexOf=function(f){for(var g=this.length;g--&&this[g]!==f;){}return g});"bind" in c||(c.bind=function(j){var i=this,h=e.slice,g=h.call(arguments,1);return function(){return i.apply(j,g.concat(h.call(arguments)))}});"trim" in d||(d.trim=function(){return this.replace(/^[^\S]+|[^\S]+$/g,"")})}(Array.prototype,Function.prototype,String.prototype));
/*! (C) WebReflection Mit Style License */
(function(z){function F(c){return typeof c=="string"?z.document.createTextNode(c):c}function m(f){if(f.length===1){return F(f[0])}for(var e=z.document.createDocumentFragment(),c=x.call(f),d=0;d<f.length;d++){e.appendChild(F(c[d]))}return e}for(var g,w,G,k=/^\s+|\s+$/g,E=/\s+/,C=" ",y=function(c,d){return this.contains(c)?d||this.remove(c):d&&this.add(c),!!d},q=(z.Element||z.Node||z.HTMLElement).prototype,B=["prepend",function(){var c=this.firstChild,d=m(arguments);c?this.insertBefore(d,c):this.appendChild(d)},"append",function(){this.appendChild(m(arguments))},"before",function(){var c=this.parentNode;c&&c.insertBefore(m(arguments),this)},"after",function(){var d=this.parentNode,e=this.nextSibling,c=m(arguments);d&&(e?d.insertBefore(c,e):d.appendChild(c))},"replace",function(){var c=this.parentNode;c&&c.replaceChild(m(arguments),this)},"remove",function(){var c=this.parentNode;c&&c.removeChild(this)}],x=B.slice,j=B.length;j;j-=2){g=B[j-2],g in q||(q[g]=B[j-1])}"classList" in document.documentElement?(G=document.createElement("div").classList,G.add("a","b"),"a b"!=G&&(q=G.constructor.prototype,"add" in q||(q=z.DOMTokenList.prototype),w=function(c){return function(){var d=0;while(d<arguments.length){c.call(this,arguments[d++])}}},q.add=w(q.add),q.remove=w(q.remove),q.toggle=y)):(w=function(c){if(!c){throw"SyntaxError"}if(E.test(c)){throw"InvalidCharacterError"}return c},G=function(d){var c=d.className.replace(k,"");c.length&&B.push.apply(this,c.split(E)),this._=d},G.prototype={length:0,add:function(){for(var c=0,d;c<arguments.length;c++){d=arguments[c],this.contains(d)||B.push.call(this,g)}this._.className=""+this},contains:function(c){return function(d){return j=c.call(this,g=w(d)),-1<j}}([].indexOf||function(c){j=this.length;while(j--&&this[j]!==c){}return j}),item:function(c){return this[c]||null},remove:function(){for(var c=0,d;c<arguments.length;c++){d=arguments[c],this.contains(d)&&B.splice.call(this,j,1)}this._.className=""+this},toggle:y,toString:function D(){return B.join.call(this,C)}},(Object.defineProperty||function(d,c,f){d.__defineGetter__(c,f.get)})(q,"classList",{get:function(){return new G(this)},set:function(){}}));try{new z.CustomEvent("?")}catch(A){z.CustomEvent=function(f,c){function h(o,e){var l=document.createEvent(f);if(typeof o!="string"){throw new Error("An event name must be provided")}return f=="Event"&&(l.initCustomEvent=d),e==null&&(e=c),l.initCustomEvent(o,e.bubbles,e.cancelable,e.detail),l}function d(o,i,p,l){this.initEvent(o,i,p),this.detail=l}return h}(z.CustomEvent?"CustomEvent":"Event",{bubbles:!1,cancelable:!1,detail:null})}})(b);
/*! (C) Andrea Giammarchi Mit Style License */
(function(aa){function H(){return{l:{},m:[],b:[]}}function q(d){var c=H();return ac.value=c,O(d,Z,ac),ac.value=null,c}function B(d,c,f){typeof c=="function"?c.apply(d,f):c.handleEvent.apply(c,f)}function j(d,c,f){f&&A(this,"detail",f),A(this,"type",c),A(this,"target",d),A(this,"timeStamp",R())}if(aa.eddy){return}aa.eddy=!0;var I=Array.prototype,Q=aa.prototype,M=j.prototype,W=Q.hasOwnProperty,J=I.push,P=I.slice,G=I.unshift,ae="toLocaleString",Z={toLocaleString:1}.propertyIsEnumerable(ae)?"_@eddy"+Math.random():ae,U=Z===ae,ac=(aa.create||aa)(null),X=[],O=U?function(d,c,f){d[c]=f.value}:aa.defineProperty,ab=function(d){var c=this;return function(){return c.apply(d,arguments)}},F=I.indexOf||function(d){var c=this.length;while(c--&&this[c]!==d){}return c},R=Date.now||function(){return(new Date).getTime()},Y={boundTo:function(e){var h=W.call(this,Z)?this[Z]:q(this),f=h.m,g=h.b,d=typeof e=="string"?this[e]:e,c=F.call(f,d);return c<0?g[J.call(f,d)-1]=ab.call(d,this):g[c]},emit:function(g){var m=W.call(this,Z),i=m&&this[Z].l,h=m&&W.call(i,g),f=h&&i[g],e=h&&P.call(arguments,1),d=0,k=h?f.length:d;while(d<k){B(this,f[d++],e)}return h},listeners:function(c){return W.call(this,Z)&&W.call(this[Z].l,c)&&this[Z].l[c].slice()||[]},off:function(d,h){var f=W.call(this,Z),e=f&&this[Z].l,g=f&&W.call(e,d)&&e[d],c;return g&&(c=F.call(g,h),-1<c&&(g.splice(c,1),g.length||delete e[d])),this},on:function(e,h,f){var g=W.call(this,Z),d=(g?this[Z]:q(this)).l,c=g&&W.call(d,e)?d[e]:d[e]=[];return F.call(c,h)<0&&(f?G:J).call(c,h),this},once:function(d,g,f){var c=function(h){e.off(d,c,f),B(e,g,arguments)},e=this;return e.on(d,c,f)},trigger:function(C,g){var E=W.call(this,Z),f=E&&this[Z].l,y=typeof C=="string",w=y?C:C.type,i=E&&W.call(f,w),r=i&&f[w].slice(0),e=y?new j(this,w,g):C,k=0,x=i?r.length:k,h=!(e instanceof j);h&&(e._active=!0,e.stopImmediatePropagation=M.stopImmediatePropagation),e.currentTarget=this,X[0]=e;while(e._active&&k<x){B(this,r[k++],X)}return h&&(delete e._active,delete e.stopImmediatePropagation),!e.defaultPrevented}},A=function(d,c,f){W.call(d,c)||(d[c]=f)},ad=!1,D;M.defaultPrevented=!1,M._active=M.cancelable=!0,M.preventDefault=function(){this.defaultPrevented=!0},M.stopImmediatePropagation=function(){this._active=!1};for(D in Y){W.call(Y,D)&&O(Q,D,{enumerable:!1,configurable:!0,writable:!0,value:Y[D]})}(function(d){function f(e){function g(h){h[e].apply(h,this)}return function(){return d.call(this,g,arguments),this}}for(var c in Y){Y.hasOwnProperty(c)&&!/^listeners|boundTo$/.test(c)&&O(I,c,{enumerable:!1,configurable:!0,writable:!0,value:f(c)})}})(I.forEach);var z={boundTo:Y.boundTo,data:function V(d,c){var f="dataset" in this;return arguments.length<2?f?this.dataset[d]:(c=this.getAttribute("data-"+d.replace(V.gre||(V.gre=/-[a-z]/g),V.gplace||(V.gplace=function(h,g){return g.toUpperCase()}))))==null?void 0:c:f?c==null?delete this.dataset[d]:(this.dataset[d]=c,c):(V.sre||(V.sre=/([a-z])([A-Z])/g,V.splace=function(h,g,i){return g+"-"+i.toLowerCase()}),d="data-"+d.replace(V.sre,V.splace),c==null?!this.removeAttribute(d):(this.setAttribute(d,c),c))},emit:function(d){var c=new CustomEvent(d);return c.arguments=I.slice.call(arguments,1),this.dispatchEvent(c)},listeners:function(c){return[]},off:function(d,c,f){return this.removeEventListener(d,c,f),this},on:function(d,c,f){return this.addEventListener(d,c,f),this},once:Y.once,trigger:function(d,g){var f=typeof d=="string",c=f?d:d.type,e=f?new CustomEvent(c,(ac.detail=g,ac)):d;return ac.detail=null,j.call(e,this,c),this.dispatchEvent(e)}};ac.cancelable=!0,ac.bubbles=!0;try{document.createEvent("Event").target=document}catch(K){ad=!0,A=function(f,c,g){if(!W.call(f,c)){try{f[c]=g}catch(d){}}}}(function(i){var f=i.Window,l=f?f.prototype:i,h=(i.Node||i.Element||i.HTMLElement).prototype,g=(i.Document||i.HTMLDocument).prototype,k=(i.XMLHttpRequest||function(){}).prototype,d,c;for(d in z){W.call(z,d)&&(c={enumerable:!1,configurable:!0,writable:!0,value:z[d]},O(l,d,c),O(h,d,c),O(g,d,c),d!=="data"&&O(k,d,c))}})(b)})(Object);b.$=function(c){return function(e,d){return c.slice.call(c.concat(d||document)[0].querySelectorAll(e))}}([]);
/*! SimpleKinetic v0.1.1 - MIT license */
;var a=function(d){var l=d.isNaN,e=d.Math,s=e.abs,r=e.round,o=e.sqrt,k=d.setInterval,p=d.clearInterval,g=0.2,q=9,m=1000/60,j=f.prototype;function f(t){for(var u in t){if(/^on|context|interval/.test(u)){this[u]=t[u]}}}j.init=function(J,I,A,w,D,B){var K=i(this),z=(s(A)<1?0:A)*(D?1:q),F=(s(w)<1?0:w)*(B?1:q),v=z*z,E=F*F,u=o(v+E),t=z/u,C=F/u,H,G;K.cancel(K._cx,K._cy);if(!(l(t)||l(C))){K._a=k(h,K.interval||m,K);K._t=0;K._d=u;K._sx=K._cx=J;K._sy=K._cy=I;K._xa=t;K._ya=C;H=r(J+u*t);G=r(I+u*C);K._ex=H;K._ey=G;if((J!==H||I!==G)&&K.start(J,I,0,0,H,G)!==false){return true}i(K._a)}return false};j.start=n("start");j.move=n("move");j.end=n("end");j.cancel=function(v,t,w,u,y,x){if(this._a){i(this).oncancel.call(this.context||this,v,t,w,u,y,x)}};j.onstart=j.onmove=j.onend=j.oncancel=function(v,t,w,u,y,x){};function i(t){p(t._a);t._a=0;return t}function n(t){t="on"+t;return function(w,u,x,v,z,y){return this[t].call(this.context||this,w,u,x,v,z,y)}}function h(v){var C=(v._t+=(v._d-v._t)*g),u=r(v._sx+C*v._xa),D=r(v._sy+C*v._ya),B=v._ex,z=v._ey,A=u-v._cx,w=D-v._cy;if(u===B&&D===z){i(v).end(B,z,A,w,B,z)}else{v.move(u,D,A,w,B,z);v._cx=u;v._cy=D}}var c=k(function(t){p(c);if(!t){k=function(w,v,u){return d.setInterval(function(){w(u)},v)}}},0,1);return f}(this);document.once("DOMContentLoaded",function(){var o=/^[^@]+?@[^\1@]+\.([a-z]{2,})$/,h=0,t={},k={handleEvent:function(w){var v=w.type,u;if("_type" in this){u=this._type+"-terminate";if(u in this){this[u](w)}}this._type=v;u=v+"-init";if(u in this){this[u](w)}s.enable($("fieldset#"+v)[0]);this[v](w)},"step-1":function(w){var v=$("fieldset#"+w.type)[0],u=$("select",v);u.once("change",function(){location.href=location.href.split(/[\?#]/)[0]+"?lang="+this.value});this.trigger("step-2")},"step-2":function(w){var v=$("fieldset#"+w.type)[0],u=$("input",v)[0];this.on("email:verified",j);u.on("keyup",this.boundTo(q));u.emit("keyup")},"step-3":function(F){var K=F.detail,I=$("fieldset"),G=$("fieldset#"+F.type)[0],v=$("select[name=activity]",G)[0],C=$("button[name=add]",G)[0],J=$("button[name=remove]",G)[0],D=$("button.next",G)[0],N=$("input[name=name]",G)[0],E=$("textarea[name=description]",G)[0],M=$("select[name=lang]",G)[0],y=$("div.lang > p > span",G)[0],z=$("ul",G)[0],B=$("div.criteria input",G),w=B.shift(),x=B.shift(),u=function(P){var O=z.appendChild(document.createElement("li")),Q=O.appendChild(document.createElement("strong"));Q.append("√");O.append(Q);O.append(" "+n(M,P))},A=function(){J.disabled=!v.options.length;D.disabled=C.disabled=!(E.value&&N.value&&(g(w)||3<B.filter(g).length));if(this.hasOwnProperty("map")){I.slice(I.indexOf(G)+1).forEach(s[D.disabled?"disable":"enable"])}}.bind(this),H;y.innerHTML=140;N.value=E.value=v.innerHTML=z.innerHTML="";v.once("change",function(){K.currentActivity=this.value;F.currentTarget.trigger(F)});N.on("keyup",this.onNameChange||(this.onNameChange=function(P){var Q=N.value.trim(),O=v.options[v.selectedIndex];p(K).name=Q;if(Q){O.value=K.currentActivity;O.innerHTML="";O.append(Q)}A()}));E.on("keyup",this.onDescriptionChange||(this.onDescriptionChange=function(S){var Q=E.value.trim(),P=parseInt(E.getAttribute("maxlength"),10),R=(P-Q.length),O;if(R<0){R=0;E.value=Q.slice(0,P)}y.innerHTML=R;O=p(K).description;if(!(M.value in O)){u(M.value)}O[M.value]=Q;if(!Q.length){delete O[M.value];z.innerHTML="";Object.keys(O).forEach(u)}A()}));M.on("change",this.onLanguageDescriptionChange||(this.onLanguageDescriptionChange=function(P){var O=p(K).description;E.value=O[M.value]||"";E.emit("keyup")}));K.activities.forEach(function(R,P){if(/^remove:/.test(R.id)){return}var Q=v.appendChild(document.createElement("option")),O;Q.value=R.id;Q.append(R.name);if(!K.hasOwnProperty("currentActivity")||R.id==K.currentActivity){K.currentActivity=R.id;Q.selected="selected";N.value=R.name;O=Object.keys(R.description);O.forEach.call(M.options,m,O[0]);O.forEach(u);E.value=R.description[M.value]||"";E.emit("keyup")}},this);C.on("click",this.onAnotherActivity||(this.onAnotherActivity=function(Q){var O=v.options,R;K.currentActivity=null;v.appendChild(document.createElement("option")).append(R=N.placeholder||N.getAttribute("placeholder"));N.value=E.value="";E.emit("keyup");try{N.focus()}catch(P){}B.concat(x,w).forEach(function(S){S.checked=false});v.selectedIndex=O.length-1}));J.on("click",this.onRemoveActivity||(this.onRemoveActivity=function(Q){var P=p(K),R=P.id,O;if(/^new:/.test(R)){for(O=0;O<K.activities.length;O++){if(K.activities[O].id==R){K.activities.splice(O,1);break}}}else{if(!/^remove:/.test(R)){P.id="remove:"+R}}K.currentActivity=null;v.selectedIndex+=v.selectedIndex?-1:1;v.emit("change")}));B.on("change",this.onCriteriaChange||(this.onCriteriaChange=function(){B.forEach(f,p(K).criteria=[]);A()}));H=K.currentActivity?d(K.activities,K.currentActivity):{criteria:[],certification:[]};B.forEach(function(O){O.checked=-1<this.criteria.indexOf(O.value);O.parentNode.on("click",c)},H);x.checked=0<H.criteria.length;w.checked=0<H.certification.length;x.on("change",this.enableAddRemoveButtons||(this.enableAddRemoveButtons=A));w.on("change",this.onCertifiedEnabled||(this.onCertifiedEnabled=function(){p(K).certification=[true];A()}));A();if(C.disabled&&J.disabled){C.emit("click")}D.on("click",this.onNextActivity||(this.onNextActivity=function(O){this.trigger("step-4",K)}.bind(this)));if(!D.disabled){D.emit("click")}},"step-4":function(z){var u=z.detail,y=$("fieldset#"+z.type)[0],v=$("i",y)[0],x=$("select[name=category]",y)[0],w=$("div.map > button",y)[0];$("fieldset",y).forEach(s.enable);if(!this.hasOwnProperty("map")){this.map=L.map("map");L.tileLayer("http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpg",{attribution:"Map Tiles &copy; Open MapQuest",maxZoom:18}).addTo(this.map);this.map.setView([navigator.country.geo.latitude,navigator.country.geo.longitude],5);w.on("click",function(){w.disabled=true;try{navigator.geolocation.getCurrentPosition(function C(D){this.setView([D.coords.latitude,D.coords.longitude],Math.max(14,this.getZoom()));w.disabled=false}.bind(this),function A(){w.disabled=false},{maximumAge:600000})}catch(B){}}.bind(this.map));x.on("change",this.onCategoryChange||(this.onCategoryChange=function(A){v.className="icon-"+x.value}))}}},e=["mousedown","mousemove","mouseup","click"],s={disable:function(u){u.classList.add("disabled");e.forEach(s._addStopEvent,u)},enable:function(u){u.classList.remove("disabled");e.forEach(s._removeStopEvent,u)},_addStopEvent:function(u){this.on(u,l,true)},_removeStopEvent:function(u){this.off(u,l,true)}};function l(u){u.preventDefault();(u.stopImmediatePropagation||u.stopPropagation).call(u)}function r(u,v){var x=v.value.trim(),w=v.data("email"),y;if(o.test(x)&&x!==w){v.data("email",x);u.xhr=y=new XMLHttpRequest;y.target=u;y.open("get","cgi/verify.php?email="+encodeURIComponent(x),true);y.on("readystatechange",i).send(null);t.email=w}}function j(v){var u=v.detail;switch(typeof u){case"object":t.activities=u;break;case"boolean":if(confirm(jslang.seeYouLater)){}location.href="http://equolo.org/";break;default:t.activities=[]}if(t.hasOwnProperty("activities")){this.trigger("step-3",t)}}function q(w){var u=w.currentTarget;t.email=null;try{this.xhr.abort()}catch(v){}clearTimeout(parseInt(u.data("timer")||0,10));if(o.test(u.value.trim())){u.data("timer",setTimeout(r,1000,this,u))}else{while(u=u.parentNode){if(u.nodeName==="FIELDSET"){$("fieldset").slice($("fieldset").indexOf(u)+1).forEach(s.disable);break}}}}function i(){if(this.readyState===4){this.target.trigger("email:verified",JSON.parse(this.responseText))}}function d(x,y){for(var v=0,w=x.length,u;v<w;v++){u=x[v];if(u.id==y){return u}}}function n(x,w){for(var u=x.options,v=0;v<u.length;v++){if(u[v].value==w){return u[v].innerHTML}}}function p(u){if(!u.currentActivity){u.activities.push({id:(u.currentActivity="new:".concat(++h)),name:"",description:{},criteria:[],certification:[],place:[]})}return d(u.activities,u.currentActivity)}function g(u){return u.checked}function c(u){if(u.target==this){this.firstChild.checked=!this.firstChild.checked;this.firstChild.emit("change")}}function m(u){u.selected=u.value==this?"selected":""}function f(u){if(u.checked){this.push(u.value)}}Object.keys(k).forEach(function(u){if(u!=="handleEvent"){this.on(u,this)}},k);$("fieldset").forEach(s.disable);k.trigger("step-1")})}(this));